<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Poultry Prep</title>

    <!-- Bootstrap CSS -->

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Allan:wght@400;700&family=Bebas+Neue&family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <!-- Dev Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css"
    />
    <link href="/css/site.css" rel="stylesheet" />
    <link href="/css/prism.css" rel="stylesheet" />

    <!-- favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
  </head>

  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark" id="mainNav">
        <div class="container">
          <a class="navbar-brand" href="#">
            <img src="/img/FOOTER (5).png" height="60" />
            Poultry Prep
          </a>
          <!-- TODO: Customize Mobile Menu Button -->
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-dm">
              <i class="bi bi-list"></i>
            </span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link" href="/index.html"
                  >Home</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/app.html">Poultry Prep</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/code.html">Code</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/danvitmon/To-Don-t" target="_blank"
                  >GitHub</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="https://danielmsportfolio.netlify.app/"
                  target="_blank"
                  >My Portfolio</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://bloggedin-4b73ab94fb79.herokuapp.com/" target="_blank">My Blog</a>
                <!-- CHANGE THI -->
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <main class="container mt-3">
        <h1 class="border-bottom border-2 border-dark">The Code</h1>
        <div class="row">
            <div class="col-12 col-lg-8">
                <pre class="line-numbers">
                    <code class="language-js">
                      function getValues() {
                        let data = localStorage.getItem("jgMealZealMeals");
                        if (data == null) {
                          document.getElementById("titleText").innerText = "Welcome!";
                        } else {
                          document.getElementById("titleText").innerText = "Welcome Back!";
                        }
                        displayAllMeals();
                        calculateAndSetDailyCards();
                      }
                      
                      function getAllMeals() {
                        let data = localStorage.getItem("jgMealZealMeals");
                      
                        if (data == null) {
                          let exampleMeals = staticMeals.map((meal) => {
                            meal.id = generateId();
                            return meal;
                          });
                          localStorage.setItem("jgMealZealMeals", JSON.stringify(exampleMeals));
                          data = localStorage.getItem("jgMealZealMeals");
                        }
                      
                        let allMeals = JSON.parse(data);
                      
                        if (
                          allMeals.some((meal) => meal.id == null) ||
                          allMeals.some((meal) => meal.id == undefined)
                        ) {
                          allMeals.forEach((meal) => (meal.id = generateId()));
                          localStorage.setItem("jgMealZealMeals", JSON.stringify(allMeals));
                        }
                      
                        allMeals = allMeals.sort((meal1, meal2) =>
                          Number(new Date(meal1.date) - new Date(meal2.date))
                        );
                        return allMeals;
                      }
                      
                      function addMeal() {
                        try {
                          let mealDate = new Date(
                            document.getElementById("newMealDate").value + "T00:00"
                          )
                            .toISOString()
                            .split("T")[0];
                          let mealName = document.getElementById("newMealName").value;
                          let mealType = document.getElementById("newMealType").value;
                          let mealCalories = parseInt(
                            document.getElementById("newMealCalories").value
                          );
                          let mealProtein = parseInt(document.getElementById("newMealProtein").value);
                          let mealFiber = parseInt(document.getElementById("newMealFiber").value);
                          let mealWater = parseInt(document.getElementById("newMealWater").value);
                      
                          if (
                            mealCalories < 0 ||
                            isNaN(mealCalories) ||
                            mealProtein < 0 ||
                            isNaN(mealProtein) ||
                            mealFiber < 0 ||
                            isNaN(mealFiber) ||
                            mealWater < 0 ||
                            isNaN(mealWater) ||
                            !mealType
                          ) {
                            Swal.fire({
                              icon: "error",
                              title: "Oops!",
                              text: "Please enter valid data.",
                              heightAuto: false,
                            });
                          } else {
                            let newMeal = {
                              id: generateId(),
                              date: mealDate,
                              name: mealName,
                              type: mealType,
                              calories: mealCalories,
                              protein: mealProtein,
                              fiber: mealFiber,
                              water: mealWater,
                            };
                      
                            let allMeals = getAllMeals();
                            allMeals.push(newMeal);
                            localStorage.setItem("jgMealZealMeals", JSON.stringify(allMeals));
                      
                            getValues();
                            document.getElementById("newMealForm").reset();
                          }
                        } catch (err) {
                          Swal.fire({
                            icon: "error",
                            title: "Oops!",
                            text: "Please enter valid data.",
                            heightAuto: false,
                          });
                        }
                      }
                      
                      function deleteMeal() {
                        let mealId = document.getElementById("editMealId").value;
                      
                        let allMeals = getAllMeals();
                      
                        let filteredMeals = allMeals.filter((meal) => meal.id != mealId);
                      
                        localStorage.setItem("jgMealZealMeals", JSON.stringify(filteredMeals));
                      
                        getValues();
                      }
                      
                      function editMeal(mealRow) {
                        let mealId = mealRow.getAttribute("data-identifier");
                      
                        let allMeals = getAllMeals();
                      
                        let mealToEdit = allMeals.find((mealObject) => mealObject.id == mealId);
                      
                        document.getElementById("editMealId").value = mealToEdit.id;
                        document.getElementById("editMealName").value = mealToEdit.name;
                        document.getElementById("editMealType").value = mealToEdit.type;
                        document.getElementById("editMealCalories").value = mealToEdit.calories;
                        document.getElementById("editMealProtein").value = mealToEdit.protein;
                        document.getElementById("editMealFiber").value = mealToEdit.fiber;
                        document.getElementById("editMealWater").value = mealToEdit.water;
                      
                        let mealDate = new Date(mealToEdit.date);
                        let mealDateString = mealDate.toISOString();
                        let formattedDate = mealDateString.split("T")[0];
                        document.getElementById("editMealDate").value = formattedDate;
                      }
                      
                      function updateMeal() {
                        try {
                          let mealId = document.getElementById("editMealId").value;
                          let mealName = document.getElementById("editMealName").value;
                          let mealType = document.getElementById("editMealType").value;
                          let mealCalories = parseInt(
                            document.getElementById("editMealCalories").value
                          );
                          let mealProtein = parseInt(
                            document.getElementById("editMealProtein").value
                          );
                          let mealFiber = parseInt(document.getElementById("editMealFiber").value);
                          let mealWater = parseInt(document.getElementById("editMealWater").value);
                      
                          let mealDate = new Date(
                            document.getElementById("editMealDate").value + "T00:00"
                          )
                            .toISOString()
                            .split("T")[0];
                      
                          if (
                            mealCalories < 0 ||
                            isNaN(mealCalories) ||
                            mealProtein < 0 ||
                            isNaN(mealProtein) ||
                            mealFiber < 0 ||
                            isNaN(mealFiber) ||
                            mealWater < 0 ||
                            isNaN(mealWater) ||
                            !mealType
                          ) {
                            Swal.fire({
                              icon: "error",
                              title: "Oops!",
                              text: "Please enter valid data.",
                              heightAuto: false,
                            });
                          } else {
                            let newMeal = {
                              id: mealId,
                              date: mealDate,
                              name: mealName,
                              type: mealType,
                              calories: mealCalories,
                              protein: mealProtein,
                              fiber: mealFiber,
                              water: mealWater,
                            };
                      
                            let allMeals = getAllMeals();
                      
                            let index = allMeals.findIndex((meal) => meal.id == mealId);
                      
                            allMeals[index] = newMeal;
                      
                            localStorage.setItem("jgMealZealMeals", JSON.stringify(allMeals));
                      
                            getValues();
                      
                            document.getElementById("editMealForm").reset();
                          }
                        } catch (err) {
                          Swal.fire({
                            icon: "error",
                            title: "Oops!",
                            text: "Please enter valid data.",
                            heightAuto: false,
                          });
                        }
                      }
                      
                      function createDailyMealsObjectArray() {
                        let days = new Set();
                        let mealsArray = getAllMeals();
                        for (let i = 0; i < mealsArray.length; i++) {
                          days.add(mealsArray[i].date);
                        }
                      
                        let dayArray = [...days];
                        let mealRows = [];
                      
                        for (let i = 0; i < dayArray.length; i++) {
                          let mealDay = {
                            date: dayArray[i],
                            calories: 0,
                            protein: 0,
                            fiber: 0,
                            water: 0,
                          };
                          for (let j = 0; j < mealsArray.length; j++) {
                            if (mealDay.date == mealsArray[j].date) {
                              mealDay.calories += mealsArray[j].calories;
                              mealDay.protein += mealsArray[j].protein;
                              mealDay.fiber += mealsArray[j].fiber;
                              mealDay.water += mealsArray[j].water;
                            }
                          }
                          mealRows.push(mealDay);
                        }
                      
                        return mealRows;
                      }
                      
                      function createWeeklyMealsObjectArray() {
                        let mealsArray = createDailyMealsObjectArray();
                        let firstDay = new Date(mealsArray[0].date + "T00:00");
                        let lastDay = new Date(mealsArray[mealsArray.length - 1].date + "T00:00");
                        let mealRows = [];
                      
                        if (firstDay.getDay() != 0) {
                          firstDay.setDate(firstDay.getDate() - firstDay.getDay());
                        }
                      
                        let difference = lastDay.getTime() - firstDay.getTime();
                        let differenceInDays = Math.round(difference / (1000 * 3600 * 24));
                      
                        for (let i = 0; i <= differenceInDays; i += 7) {
                          let dummyDate = new Date(firstDay.getTime() + i * 24 * 3600 * 1000);
                          let dummyDateString = dummyDate.toISOString().split("T")[0];
                      
                          let mealWeek = {
                            date: dummyDateString,
                            calories: 0,
                            protein: 0,
                            fiber: 0,
                            water: 0,
                            count: 0,
                          };
                      
                          for (let j = 0; j < mealsArray.length; j++) {
                            let currentMeal = mealsArray[j];
                            let currentMealDate = new Date(currentMeal.date + "T00:00");
                            let currentMealDateMinusItself = new Date(
                              currentMealDate.getTime() - currentMealDate.getDay() * 24 * 3600 * 1000
                            );
                            if (
                              currentMealDateMinusItself.toDateString() == dummyDate.toDateString()
                            ) {
                              mealWeek.calories += currentMeal.calories;
                              mealWeek.protein += currentMeal.protein;
                              mealWeek.fiber += currentMeal.fiber;
                              mealWeek.water += currentMeal.water;
                              mealWeek.count++;
                            }
                          }
                          mealWeek.calories =
                            Math.round((mealWeek.calories / mealWeek.count) * 100) / 100;
                          mealWeek.protein =
                            Math.round((mealWeek.protein / mealWeek.count) * 100) / 100;
                          mealWeek.fiber = Math.round((mealWeek.fiber / mealWeek.count) * 100) / 100;
                          mealWeek.water = Math.round((mealWeek.water / mealWeek.count) * 100) / 100;
                      
                          if (
                            mealWeek.calories > 0 ||
                            mealWeek.protein > 0 ||
                            mealWeek.fiber > 0 ||
                            mealWeek.water > 0
                          ) {
                            mealRows.push(mealWeek);
                          }
                        }
                        return mealRows;
                      }
                      
                      function createMonthlyMealsObjectArray() {
                        let mealsArray = createDailyMealsObjectArray();
                      
                        let mealRows = [];
                        let mealMonths = new Set();
                      
                        for (let i = 0; i < mealsArray.length; i++) {
                          let mealMonthArray = mealsArray[i].date.split("-");
                          let mealMonth = mealMonthArray[0] + "-" + mealMonthArray[1];
                          mealMonths.add(mealMonth);
                        }
                      
                        let mealMonthsArray = [...mealMonths];
                      
                        for (let i = 0; i < mealMonthsArray.length; i++) {
                          let count = 0;
                          mealMonthData = {
                            date: mealMonthsArray[i],
                            calories: 0,
                            protein: 0,
                            fiber: 0,
                            water: 0,
                          };
                      
                          for (let j = 0; j < mealsArray.length; j++) {
                            let mealDate = new Date(mealsArray[j].date + "T00:00")
                              .toISOString()
                              .split("T")[0];
                            let month = mealDate.split("-")[0] + "-" + mealDate.split("-")[1];
                      
                            if (mealMonthsArray[i] == month) {
                              mealMonthData.calories += mealsArray[j].calories;
                              mealMonthData.protein += mealsArray[j].protein;
                              mealMonthData.fiber += mealsArray[j].fiber;
                              mealMonthData.water += mealsArray[j].water;
                              count++;
                            }
                          }
                          mealMonthData.calories =
                            Math.round((mealMonthData.calories / count) * 100) / 100;
                          mealMonthData.protein =
                            Math.round((mealMonthData.protein / count) * 100) / 100;
                          mealMonthData.fiber = Math.round((mealMonthData.fiber / count) * 100) / 100;
                          mealMonthData.water = Math.round((mealMonthData.water / count) * 100) / 100;
                      
                          if (
                            mealMonthData.calories > 0 ||
                            mealMonthData.protein > 0 ||
                            mealMonthData.fiber > 0 ||
                            mealMonthData.water > 0
                          ) {
                            mealRows.push(mealMonthData);
                          }
                        }
                        return mealRows;
                      }
                      
                      function createYearlyMealsObjectArray() {
                        let mealsArray = createDailyMealsObjectArray();
                      
                        let mealRows = [];
                        let mealYears = new Set();
                      
                        for (let i = 0; i < mealsArray.length; i++) {
                          let mealYearArray = mealsArray[i].date.split("-");
                          let mealYear = mealYearArray[0];
                          mealYears.add(mealYear);
                        }
                      
                        let mealYearsArray = [...mealYears];
                      
                        for (let i = 0; i < mealYearsArray.length; i++) {
                          let count = 0;
                          mealYearData = {
                            date: mealYearsArray[i],
                            calories: 0,
                            protein: 0,
                            fiber: 0,
                            water: 0,
                          };
                      
                          for (let j = 0; j < mealsArray.length; j++) {
                            let mealDate = new Date(mealsArray[j].date + "T00:00")
                              .toISOString()
                              .split("T")[0];
                            let year = mealDate.split("-")[0];
                      
                            if (mealYearsArray[i] == year) {
                              mealYearData.calories += mealsArray[j].calories;
                              mealYearData.protein += mealsArray[j].protein;
                              mealYearData.fiber += mealsArray[j].fiber;
                              mealYearData.water += mealsArray[j].water;
                              count++;
                            }
                          }
                          mealYearData.calories =
                            Math.round((mealYearData.calories / count) * 100) / 100;
                          mealYearData.protein =
                            Math.round((mealYearData.protein / count) * 100) / 100;
                          mealYearData.fiber = Math.round((mealYearData.fiber / count) * 100) / 100;
                          mealYearData.water = Math.round((mealYearData.water / count) * 100) / 100;
                      
                          if (
                            mealYearData.calories > 0 ||
                            mealYearData.protein > 0 ||
                            mealYearData.fiber > 0 ||
                            mealYearData.water > 0
                          ) {
                            mealRows.push(mealYearData);
                          }
                        }
                        return mealRows;
                      }
                      
                      function displayAllMeals() {
                        let mealsArray = getAllMeals();
                        mealsArray = mealsArray.sort((meal1, meal2) =>
                          Number(new Date(meal2.date) - new Date(meal1.date))
                        );
                        let rowTemplate = document.getElementById("allTableRowTemplate");
                        let headerTemplate = document.getElementById("allTableHeaderTemplate");
                        mealTableHeader.innerHTML = "";
                        mealTableHeader.appendChild(
                          document.importNode(headerTemplate.content, true)
                        );
                        mealTableBody.innerHTML = "";
                        for (let i = 0; i < mealsArray.length; i++) {
                          let meal = mealsArray[i];
                      
                          let tableRow = document.importNode(rowTemplate.content, true);
                      
                          tableRow.querySelector('[data-id="date"]').textContent = meal.date;
                          tableRow.querySelector('[data-id="mealName"]').textContent = meal.name;
                          tableRow.querySelector('[data-id="mealType"]').textContent = meal.type;
                          tableRow.querySelector('[data-id="calories"]').textContent = meal.calories;
                          tableRow.querySelector('[data-id="protein"]').textContent = meal.protein;
                          tableRow.querySelector('[data-id="fiber"]').textContent = meal.fiber;
                          tableRow.querySelector('[data-id="water"]').textContent = meal.water;
                      
                          tableRow.querySelector("tr").setAttribute("data-identifier", meal.id);
                      
                          mealTableBody.appendChild(tableRow);
                        }
                        document.getElementById("tableTrackingText").innerText = "All Meals";
                      }
                      
                      function displayFilteredMeals(filteredMealsArray, timeFrame) {
                        let mealsArray = filteredMealsArray;
                        mealsArray = mealsArray.sort((meal1, meal2) =>
                          Number(new Date(meal2.date) - new Date(meal1.date))
                        );
                        // reset meal table
                        mealTableHeader.innerHTML = "";
                        mealTableBody.innerHTML = "";
                      
                        // assign appropriate table templates to variables
                        let headerTemplate = document.getElementById("filteredTableHeaderTemplate");
                        let rowTemplate = document.getElementById("filteredTableRowTemplate");
                      
                        // append table header template to meal table header
                        mealTableHeader.appendChild(
                          document.importNode(headerTemplate.content, true)
                        );
                      
                        // iterate through meals array argument
                        for (let i = 0; i < mealsArray.length; i++) {
                          // deep copy appropriate row template and assign to a variable
                          let tableRow = document.importNode(rowTemplate.content, true);
                      
                          // input appropriate data to each table row cell
                          tableRow.querySelector('[data-id="date"]').textContent = mealsArray[i].date;
                          tableRow.querySelector('[data-id="calories"]').textContent =
                            mealsArray[i].calories;
                          tableRow.querySelector('[data-id="protein"]').textContent =
                            mealsArray[i].protein;
                          tableRow.querySelector('[data-id="fiber"]').textContent =
                            mealsArray[i].fiber;
                          tableRow.querySelector('[data-id="water"]').textContent =
                            mealsArray[i].water;
                      
                          // append create table row to meal table body
                          mealTableBody.appendChild(tableRow);
                        }
                      
                        let timeFrameText = document.getElementById("timeFrame");
                        let tableTrackingText = document.getElementById("tableTrackingText");
                      
                        if (timeFrame == "Daily") {
                          timeFrameText.innerText = "Date";
                          tableTrackingText.innerText = "Daily Totals";
                        } else if (timeFrame == "Weekly") {
                          timeFrameText.innerText = "Week Of";
                          tableTrackingText.innerText = "Daily Averages / Week";
                        } else if (timeFrame == "Monthly") {
                          timeFrameText.innerText = "Month";
                          tableTrackingText.innerText = "Daily Averages / Month";
                        } else if (timeFrame == "Yearly") {
                          timeFrameText.innerText = "Year";
                          tableTrackingText.innerText = "Daily Averages / Year";
                        }
                      }
                      
                      function generateId() {
                        return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, (c) =>
                          (
                            c ^
                            (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))
                          ).toString(16)
                        );
                      }
                      
                      function calculateAndSetDailyCards() {
                        let dailyMeals = getAllMeals();
                      
                        let calorieCount = 0;
                        let proteinCount = 0;
                        let fiberCount = 0;
                        let waterCount = 0;
                      
                        let today = new Date();
                      
                        for (let i = 0; i < dailyMeals.length; i++) {
                          mealDate = new Date(dailyMeals[i].date + "T00:00");
                          if (mealDate.toDateString() == today.toDateString()) {
                            calorieCount += dailyMeals[i].calories;
                            proteinCount += dailyMeals[i].protein;
                            fiberCount += dailyMeals[i].fiber;
                            waterCount += dailyMeals[i].water;
                            break;
                          }
                        }
                      
                        document.getElementById("calorieCount").textContent = calorieCount;
                        document.getElementById("proteinCount").textContent = proteinCount;
                        document.getElementById("fiberCount").textContent = fiberCount;
                        document.getElementById("waterCount").textContent = waterCount;
                      
                        document.getElementById("cardTrackingText").innerText = "Today's Totals";
                      }
                      
                      function calculateAndSetWeeklyCards() {
                        let mealsArray = createWeeklyMealsObjectArray();
                      
                        let calorieCount = 0;
                        let proteinCount = 0;
                        let fiberCount = 0;
                        let waterCount = 0;
                      
                        let today = new Date();
                        let dummyWeek = new Date(today.getTime() - today.getDay() * 24 * 3600 * 1000);
                        let dummyWeekString = dummyWeek.toDateString();
                        let currentWeekString = new Date(dummyWeekString).toISOString().split("T")[0];
                      
                        for (let i = 0; i < mealsArray.length; i++) {
                          if (currentWeekString == mealsArray[i].date) {
                            calorieCount += mealsArray[i].calories;
                            proteinCount += mealsArray[i].protein;
                            fiberCount += mealsArray[i].fiber;
                            waterCount += mealsArray[i].water;
                            break;
                          }
                        }
                      
                        document.getElementById("calorieCount").textContent = calorieCount;
                        document.getElementById("proteinCount").textContent = proteinCount;
                        document.getElementById("fiberCount").textContent = fiberCount;
                        document.getElementById("waterCount").textContent = waterCount;
                      
                        document.getElementById("cardTrackingText").innerText =
                          "Daily Averages this Week";
                      }
                      
                      function calculateAndSetMonthlyCards() {
                        let mealsArray = createMonthlyMealsObjectArray();
                      
                        let calorieCount = 0;
                        let proteinCount = 0;
                        let fiberCount = 0;
                        let waterCount = 0;
                      
                        let currentDate = new Date().toISOString().split("T")[0];
                        let currentMonth =
                          currentDate.split("-")[0] + "-" + currentDate.split("-")[1];
                      
                        for (let i = 0; i < mealsArray.length; i++) {
                          if (mealsArray[i].date == currentMonth) {
                            calorieCount += mealsArray[i].calories;
                            proteinCount += mealsArray[i].protein;
                            fiberCount += mealsArray[i].fiber;
                            waterCount += mealsArray[i].water;
                            break;
                          }
                        }
                      
                        document.getElementById("calorieCount").textContent = calorieCount;
                        document.getElementById("proteinCount").textContent = proteinCount;
                        document.getElementById("fiberCount").textContent = fiberCount;
                        document.getElementById("waterCount").textContent = waterCount;
                      
                        document.getElementById("cardTrackingText").innerText =
                          "Daily Averages this Month";
                      }
                      
                      function calculateAndSetYearlyCards() {
                        let mealsArray = createYearlyMealsObjectArray();
                      
                        let calorieCount = 0;
                        let proteinCount = 0;
                        let fiberCount = 0;
                        let waterCount = 0;
                      
                        let currentDate = new Date().toISOString().split("T")[0];
                        let currentYear = currentDate.split("-")[0];
                      
                        for (let i = 0; i < mealsArray.length; i++) {
                          if (mealsArray[i].date == currentYear) {
                            calorieCount += mealsArray[i].calories;
                            proteinCount += mealsArray[i].protein;
                            fiberCount += mealsArray[i].fiber;
                            waterCount += mealsArray[i].water;
                            break;
                          }
                        }
                      
                        document.getElementById("calorieCount").textContent = calorieCount;
                        document.getElementById("proteinCount").textContent = proteinCount;
                        document.getElementById("fiberCount").textContent = fiberCount;
                        document.getElementById("waterCount").textContent = waterCount;
                      
                        document.getElementById("cardTrackingText").innerText =
                          "Daily Averages this Year";
                      }
                      
                      function filterMeals(filter) {
                        if (filter == "All") {
                          displayAllMeals();
                        } else if (filter == "Daily") {
                          let filteredMealsArray = createDailyMealsObjectArray();
                          displayFilteredMeals(filteredMealsArray, filter);
                        } else if (filter == "Weekly") {
                          let filteredMealsArray = createWeeklyMealsObjectArray();
                          displayFilteredMeals(filteredMealsArray, filter);
                        } else if (filter == "Monthly") {
                          let filteredMealsArray = createMonthlyMealsObjectArray();
                          displayFilteredMeals(filteredMealsArray, filter);
                        } else if (filter == "Yearly") {
                          let filteredMealsArray = createYearlyMealsObjectArray();
                          displayFilteredMeals(filteredMealsArray, filter);
                        }
                      }
                      
                      function filterCards(filter) {
                        if (filter == "Today") {
                          calculateAndSetDailyCards();
                        } else if (filter == "Week") {
                          calculateAndSetWeeklyCards();
                        } else if (filter == "Month") {
                          calculateAndSetMonthlyCards();
                        } else if (filter == "Year") {
                          calculateAndSetYearlyCards();
                        }
                      }

                    </code>
                </pre>
            </div>
            <div class="col-12 col-lg-4">
              <p>Here's how the code functions:
              </br>
              </br>
                The getValues function is responsible for retrieving the meal data from the browser's localStorage and updating the welcome message displayed on the webpage. It then calls the displayAllMeals and calculateAndSetDailyCards functions to show all the meals and generate the daily meal summaries.
                
              </br>
              </br>
                The getAllMeals function retrieves the meal data from the localStorage. If the data is null (no meals exist), it generates example meals using a predefined array called staticMeals. Each example meal is assigned a unique ID using the generateId function, and the array is stored in the localStorage. After retrieving the meal data, it checks if any meals have missing IDs and assigns IDs to those meals. The meals are then sorted based on their date and returned.
                
              </br>
              </br>
                The addMeal function is triggered when a user adds a new meal through an HTML form. It retrieves the input values for the new meal, performs validation checks to ensure the values are valid, and creates a new meal object. The new meal is then added to the existing array of meals retrieved from the localStorage, and the updated array is stored back in the localStorage. The getValues function is called to refresh the displayed meal data, and the form is reset.
                
              </br>
              </br>
                The deleteMeal function is called when a user wants to delete a meal. It retrieves the ID of the meal to be deleted, retrieves all the meals from the localStorage, filters out the meal with the matching ID, updates the localStorage with the filtered meals, and calls getValues to refresh the displayed meal data.
                
              </br>
              </br>
                The editMeal function is triggered when a user selects a meal for editing. It retrieves the ID of the selected meal, retrieves all the meals from the localStorage, finds the meal with the matching ID, and populates an edit form with the meal's data.
                
              </br>
              </br>
                The updateMeal function is called when a user updates a meal after editing. It retrieves the updated input values, performs validation checks, creates an updated meal object, retrieves all the meals from the localStorage, finds the index of the meal to be updated, replaces the old meal with the updated one in the array, updates the localStorage with the updated array, calls getValues to refresh the displayed meal data, and resets the form.
                
              </br>
              </br>
                The createDailyMealsObjectArray function generates an array of objects representing daily meal summaries. It retrieves all the meals, iterates over them, calculates the total calories, protein, fiber, and water intake for each unique date, and creates an object for each date with the corresponding values. These objects are then pushed into an array, which is returned.
                
              </br>
              </br>
                The createWeeklyMealsObjectArray function generates an array of objects representing weekly meal summaries. It first calls the createDailyMealsObjectArray function to get the daily meal summaries. It determines the first and last dates in the array and calculates the number of days between them. Then, it iterates over the dates at weekly intervals, calculates the total values for each week, and creates an object for each week with the corresponding values. These objects are pushed into an array, which is returned.</p>
              <p>The createMonthlyMealsObjectArray function generates an array of objects representing monthly meal summaries. It first calls the createDailyMealsObjectArray function to get the daily meal summaries. It then iterates over the daily meal summaries, extracts the year and month from the date, and creates a unique identifier for each month. It calculates the total values for each month by accumulating the values from the daily meal summaries that correspond to that month. Finally, it calculates the average values for each month by dividing the total values by the number of days in that month. The resulting monthly meal summaries are added to an array and returned.
              </br>
              </br>

                The createYearlyMealsObjectArray function generates an array of objects representing yearly meal summaries. It follows a similar process as the createMonthlyMealsObjectArray function, but instead calculates the totals and averages for each year. The year is extracted from the date, and the yearly meal summaries are added to an array and returned.
              </br>
              </br>
                
                The displayAllMeals function is responsible for displaying all the meals in a table on the webpage. It retrieves all the meals using the getAllMeals function and sorts them in descending order based on the date. It then iterates over the meals and creates table rows dynamically by cloning row templates from the HTML document. The relevant data from each meal is inserted into the table cells, and the table rows are appended to the table body.
              </br>
              </br>
                
                The displayFilteredMeals function is similar to displayAllMeals, but it takes an array of filtered meals as an argument. It sorts the filtered meals and dynamically creates table rows to display the filtered meal data.
              </br>
              </br>
                
                The calculateAndSetDailyCards function calculates the daily totals for calories, protein, fiber, and water intake. It retrieves all the meals using the getAllMeals function and iterates over them to find the meals that match the current date. It accumulates the values for the matching meals and updates the respective HTML elements to display the daily totals.
              </br>
              </br></p>
              <p>The calculateAndSetWeeklyCards function calculates the weekly totals for calories, protein, fiber, and water intake. It calls the createWeeklyMealsObjectArray function to get the weekly meal summaries and iterates over them to find the week that matches the current week. It accumulates the values for the matching week and updates the respective HTML elements to display the weekly totals.
              </br>
              </br>

                The calculateAndSetMonthlyCards function calculates the monthly totals for calories, protein, fiber, and water intake. It calls the createMonthlyMealsObjectArray function to get the monthly meal summaries and iterates over them to find the month that matches the current month. It accumulates the values for the matching month and updates the respective HTML elements to display the monthly totals.
              </br>
              </br>
                
                The calculateAndSetYearlyCards function calculates the yearly totals for calories, protein, fiber, and water intake. It calls the createYearlyMealsObjectArray function to get the yearly meal summaries and iterates over them to find the year that matches the current year. It accumulates the values for the matching year and updates the respective HTML elements to display the yearly totals.
              </br>
              </br>
                
                The filterMeals function is responsible for filtering and displaying meals based on the selected filter. It takes a filter argument and checks the value to determine which type of meals to display. If the filter is "All," it calls the displayAllMeals function to display all meals. If the filter is "Daily," "Weekly," "Monthly," or "Yearly," it calls the respective functions to generate the filtered meal summaries and then calls the displayFilteredMeals function to display the filtered meals in a table.
              </br>
              </br>
                
                The filterCards function is similar to filterMeals, but it is used to filter and update the summary cards based on the selected filter. It takes a filter argument and checks the value to determine which type of summary card to calculate and set. It calls the respective functions (calculateAndSetDailyCards, calculateAndSetWeeklyCards, calculateAndSetMonthlyCards, calculateAndSetYearlyCards) to calculate and update the summary card values.</p>
            </div>
        </div>
    </main>

    <footer class="py-3">
      <div
        class="footer-main py-3 row row-cols-1 row-cols-md-3 container-fluid align-items-center text-center"
      >
        <div class="col py-2">
          <img src="/img/FOOTER (5).png" height="80" />
        </div>
        <div class="col text-md-end py-2">
          <a href="https://www.linkedin.com/in/daniel-monastirsky-1625ba173" target="_blank"
            ><i
              class="bi bi-linkedin socialicons p-2"
              style="font-size: 1.5em"
            ></i
          ></a>
          <a href="https://github.com/danvitmon" target="_blank"
            ><i
              class="bi bi-github socialicons p-2"
              style="font-size: 1.5em"
            ></i
          ></a>
          <a href="https://www.youtube.com/channel/UC8MUuKgHxmTa1aHw9DhV_LA" target="_blank"
            ><i
              class="bi bi-youtube socialicons p-2"
              style="font-size: 1.5em"
            ></i
          ></a>
        </div>
        <div class="col text-light order-md-first text-md-start py-2">
          &copy; 2023 Daniel Monastirsky
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"
    ></script>

    <script src="/js/prism.js"></script>

    <script>
        Prism.plugins.NormalizeWhitespace.setDefaults({
            'remove-trailing': true,
            'remove-indent': true,
            'left-trim': true,
            'right-trim': true
        })
    </script>
  </body>
</html>
